Плагин для Wireshark для поддержки стримового протокола Visicron. Написан на
Lua 5.2.

Возможности:
  1. Декодирование handshake: заголовок для любых типов handshake, тело только
     для _VS_STREAMS_.
  2. Декодирование фреймов со всеми заголовками (stream::FrameHeader,
     stream::SliceHeader, stream::SVCHeader, ит.д.)
  3. Декодирование команд (stream::Command) вместе с VS_MediaFormat.
  4. Декодирование видео данных как H264/VP8 с использованием встроенных в
     Wireshark декодеров. Может серьёзно замедлить Wireshark, поэтому
     включается отдельной опцией (по умолчанию выключено).
  5. Проверка корректности контрольных сумм, указанных размеров частей
     сообщений ит.п.
  6. Анализ трека видео на предмет потерянных слайсов/кадров.
  7. Дамп медиа данных в файлы, пункт меню "Tools->Visicron stream dump".
     Можно указать папку куда сохранять дампы (по умолчанию "Мои документы") и
     префикс имен файлов. Если указан фильтр пакетов, то будут сохранены
     только медиа потоки из пакетов подходящих под фильтр. Таким образом можно
     сделать дамп только нужного медиа потока (например сделав "Follow TCP
     Stream").

Установка:
  1. Скопировать vs.lua в %AppData%\Wireshark\plugins\ (Win) или в
     ~/.wireshark/plugins/ (Linux,Mac(?))

Для работы нужен Wireshark собранный с Lua 5.2 (последняя версия на момент
написания годится), иначе будет ругаться на отсутствие библиотеки bit32
(в теории её можно достать и для Lua 5.1).

TODO:
  1. Heuristic dissector, чтобы автоматически ловить протокол на портах
     отличных от 4307.
  2. Поддержка других типов handshake (если они передаются в незашифрованном
     виде).
  3. Track 5. Незнаю что это такое, но иногда встречается в дампах и упомянут в
     handshake.
  4. NHP
  5. Режим угадывания присутствия SVC header.

vim: et
